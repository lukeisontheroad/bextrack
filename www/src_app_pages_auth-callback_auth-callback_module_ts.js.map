{"version":3,"file":"src_app_pages_auth-callback_auth-callback_module_ts.js","mappings":"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","sources":["./src/app/pages/auth-callback/auth-callback.module.ts","./src/app/pages/auth-callback/auth-callback.page.ts","./src/app/pages/auth-callback/auth-callback.page.html"],"sourcesContent":["import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { AuthCallbackPage } from './auth-callback.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: AuthCallbackPage\n  }\n];\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    RouterModule.forChild(routes)\n  ],\n  declarations: [AuthCallbackPage]\n})\nexport class AuthCallbackPageModule {}\n","import { Component, OnInit, OnDestroy } from '@angular/core';\nimport { NavController } from '@ionic/angular';\nimport { Router } from '@angular/router';\nimport { AuthActions, IAuthAction, AuthObserver, AuthService } from 'ionic-appauth';\nimport { ApiService } from 'src/app/services/api/api.service';\nimport { UtilsService } from 'src/app/services/utils/utils.service';\n\n@Component({\n  selector: 'app-auth-callback',\n  templateUrl: './auth-callback.page.html',\n  styleUrls: ['./auth-callback.page.scss'],\n})\nexport class AuthCallbackPage implements OnInit, OnDestroy {\n  observer: AuthObserver;\n\n  constructor(\n    private auth: AuthService,\n    private apiService: ApiService,\n    private utilsService: UtilsService,\n    private navCtrl: NavController,\n    private router: Router\n  ) { }\n\n  ngOnInit() {\n    this.observer = this.auth.addActionListener((action) => this.postCallback(action));\n    this.auth.handleCallback(window.location.origin + this.router.url);\n  }\n\n  ngOnDestroy() {\n    this.auth.removeActionObserver(this.observer);\n  }\n\n  async postCallback(action: IAuthAction) {\n    if (action.action === AuthActions.SignInSuccess) {\n      try {\n        await this.apiService.init()\n        this.navCtrl.navigateRoot('tabs')\n      } catch (e) {\n        if(e.error && e.error.error_code && e.error.error_code == 403 && e.error.message && e.error.message == 'You are not allowed to access this ressource.'){\n          this.utilsService.showToast('no-time-permissions')\n        }else if(e.error && e.error.message){\n          this.utilsService.showToast(e.error.message)\n        }else if(e.message){\n          this.utilsService.showToast(e.message)\n        }else{\n          this.utilsService.showToast('Error: ' + JSON.stringify(e))\n        }\n        this.navCtrl.navigateRoot('login')\n      }\n    }\n\n    if (action.action === AuthActions.SignInFailed) {\n      this.utilsService.showToast('sign-in-failed')\n      console.log('SignInFailed redirect to login')\n      this.navCtrl.navigateRoot('login');\n    }\n  }\n\n}\n","<ion-content color=\"primary\">\n  <ion-spinner color=\"secondary\" style=\"position: absolute; left: 40%; top: 40%; width:20%; height:20%;\"></ion-spinner>\n</ion-content>"],"names":["CommonModule","FormsModule","RouterModule","IonicModule","AuthCallbackPage","routes","path","component","AuthCallbackPageModule","forChild","declarations","imports","AuthActions","constructor","auth","apiService","utilsService","navCtrl","router","ngOnInit","observer","addActionListener","action","postCallback","handleCallback","window","location","origin","url","ngOnDestroy","removeActionObserver","SignInSuccess","_this","init","navigateRoot","e","error","error_code","message","showToast","JSON","stringify","SignInFailed","console","log","selectors","decls","vars","consts","template","i0"],"sourceRoot":"webpack:///","x_google_ignoreList":[]}