"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5271],{5271:($,m,s)=>{s.r(m),s.d(m,{MicrophonePageModule:()=>R});var d=s(177),p=s(9417),h=s(3871),t=s(4742),v=s(3955),T=s(8548),j=s(5553),_=s(1683),f=s(467),u=s(8),S=s(8694),M=s(7792),e=s(6996),b=s(6929),C=s(5217),P=s(9893);function y(o,l){if(1&o){const i=e.RV6();e.j41(0,"ion-buttons",7)(1,"ion-button",8),e.bIt("click",function(){e.eBV(i);const r=e.XpG();return e.Njj(r.save())}),e.nrm(2,"ion-icon",9),e.k0s()()}}function F(o,l){1&o&&e.nrm(0,"ion-spinner",10)}function G(o,l){if(1&o&&(e.j41(0,"ion-select-option",18),e.EFF(1),e.k0s()),2&o){const i=l.$implicit;e.Y8G("value",i.id),e.R7$(1),e.JRh(i.name)}}function I(o,l){if(1&o){const i=e.RV6();e.j41(0,"ion-card")(1,"ion-card-content")(2,"ion-select",11),e.bIt("ngModelChange",function(r){const a=e.eBV(i).$implicit;return e.Njj(a.project_id=r)}),e.DNE(3,G,2,2,"ion-select-option",12),e.k0s(),e.nrm(4,"ion-textarea",13),e.j41(5,"ion-item",14)(6,"ion-range",15),e.bIt("ngModelChange",function(r){const a=e.eBV(i).$implicit;return e.Njj(a.hours_spent=r)}),e.k0s()(),e.j41(7,"ion-item",14)(8,"span",16),e.EFF(9),e.nI1(10,"toDuration"),e.nI1(11,"translate"),e.k0s()(),e.j41(12,"ion-item",14)(13,"ion-toggle",17),e.bIt("ngModelChange",function(r){const a=e.eBV(i).$implicit;return e.Njj(a.allowable_bill=r)}),e.EFF(14,"Billable"),e.k0s()()()()}if(2&o){const i=l.$implicit,n=e.XpG();e.R7$(2),e.Y8G("ngModel",i.project_id),e.R7$(1),e.Y8G("ngForOf",n.projects),e.R7$(1),e.FS9("value",i.notes),e.Y8G("autoGrow",!0),e.R7$(2),e.Y8G("min",n.steps)("step",n.steps)("ngModel",i.hours_spent),e.R7$(3),e.Lme("",e.bMT(10,10,i.hours_spent)," ",e.bMT(11,12,"hour(s)"),""),e.R7$(4),e.Y8G("ngModel",i.allowable_bill)}}function x(o,l){1&o&&(e.j41(0,"ion-content",19)(1,"ion-row",20),e.nrm(2,"ion-progress-bar",21),e.j41(3,"p"),e.EFF(4," Saving... "),e.k0s()()())}let N=(()=>{var o;class l{constructor(n,r,g,a,c){this.apiService=n,this.storageService=r,this.router=g,this.utils=a,this.cdr=c,this.datePipe=new d.vh("en-US"),this.isSaving=!1,this.projects=[],this.steps=1,this.suggestedTimes=[],this.init()}init(){var n=this;return(0,f.A)(function*(){const r=JSON.parse(yield n.storageService.getString("recording","[]"));n.suggestedTimes=r.map(g=>({...g,user_id:-1,client_service_id:-1,allowable_bill:!1,tracking:{type:"duration"}})),n.projects=yield n.apiService.getProjects(),n.steps=(yield n.storageService.getNumber(u.O3.SETTINGS_STEPS,u.zY.STEPS))/60,n.cdr.detectChanges()})()}save(){var n=this;return(0,f.A)(function*(){n.isSaving=!0;const r=yield n.apiService.getUser(),g=yield n.storageService.getNumber(u.O3.SETTINGS_LAST_SERVICE_ID);for(let a=0;a<n.suggestedTimes.length;a++){const c=new S.d;c.pr_project_id=n.suggestedTimes[a].project_id,c.text=n.suggestedTimes[a].notes,c.user_id=r.id,c.client_service_id=g,c.allowable_bill=n.suggestedTimes[a].allowable_bill,c.tracking.date=n.datePipe.transform(new Date,"yyyy-MM-dd"),c.tracking.duration=(new M.W).transform(n.suggestedTimes[a].hours_spent),yield n.apiService.postTimesheet(c)}n.isSaving=!1,n.cdr.detectChanges(),n.utils.showToast("Timesheets saved successfully"),n.router.navigateByUrl("/tabs/times")})()}}return(o=l).\u0275fac=function(n){return new(n||o)(e.rXU(b.G),e.rXU(C.n),e.rXU(h.Ix),e.rXU(P.T),e.rXU(e.gRc))},o.\u0275cmp=e.VBU({type:o,selectors:[["app-microphone"]],decls:14,vars:8,consts:[["color","primary"],["slot","start"],["mode","md","defaultHref","/tabs/projects"],["slot","end",4,"ngIf"],["slot","end","color","light",4,"ngIf"],[4,"ngFor","ngForOf"],[3,"isOpen","initialBreakpoint"],["slot","end"],[3,"click"],["slot","icon-only","name","save"],["slot","end","color","light"],["label","Project",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["label","Notes","placeholder","Notes","fill","outline",3,"autoGrow","value"],["lines","none"],["max","12","snaps","true","ticks","false",3,"min","step","ngModel","ngModelChange"],[2,"width","100%","text-align","center","padding","16px"],[3,"ngModel","ngModelChange"],[3,"value"],[1,"ion-padding"],[1,"ion-justify-content-center","ion-padding"],["type","indeterminate"]],template:function(n,r){1&n&&(e.j41(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-buttons",1),e.nrm(3,"ion-back-button",2),e.k0s(),e.DNE(4,y,3,0,"ion-buttons",3),e.DNE(5,F,1,0,"ion-spinner",4),e.j41(6,"ion-title"),e.EFF(7),e.nI1(8,"translate"),e.k0s()()(),e.j41(9,"ion-content")(10,"ion-list"),e.DNE(11,I,15,14,"ion-card",5),e.k0s(),e.j41(12,"ion-modal",6),e.DNE(13,x,5,0,"ng-template"),e.k0s()()),2&n&&(e.R7$(4),e.Y8G("ngIf",!r.isSaving),e.R7$(1),e.Y8G("ngIf",r.isSaving),e.R7$(2),e.JRh(e.bMT(8,6,"Create efforts")),e.R7$(4),e.Y8G("ngForOf",r.suggestedTimes),e.R7$(1),e.Y8G("isOpen",r.isSaving)("initialBreakpoint",.2))},dependencies:[d.Sq,d.bT,p.BC,p.vS,t.Jm,t.QW,t.b_,t.I9,t.W9,t.eU,t.iq,t.uz,t.nf,t.FH,t.Ob,t.ln,t.Nm,t.Ip,t.w2,t.nc,t.BC,t.BY,t.ai,t.Sb,t.hB,t.su,t.Je,t.Gw,t.el,v.D9,M.W],styles:["ion-spinner[_ngcontent-%COMP%]{margin-right:12px}ion-item[_ngcontent-%COMP%]{--ion-background-color: rgba(0, 0, 0, 0)}.type[_ngcontent-%COMP%]{margin:8px;padding:8px;border-radius:7px;background-color:#eee}"]}),l})(),R=(()=>{var o;class l{}return(o=l).\u0275fac=function(n){return new(n||o)},o.\u0275mod=e.$C({type:o}),o.\u0275inj=e.G2t({providers:[T.rz],imports:[j.h,d.MD,p.YN,t.bv,v.h,_.Y,h.iI.forChild([{path:"",component:N}])]}),l})()}}]);