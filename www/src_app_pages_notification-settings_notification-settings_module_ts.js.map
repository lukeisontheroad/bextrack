{"version":3,"file":"src_app_pages_notification-settings_notification-settings_module_ts.js","mappings":"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","sources":["./src/app/pages/notification-settings/notification-settings-routing.module.ts","./src/app/pages/notification-settings/notification-settings.module.ts","./src/app/pages/notification-settings/notification-settings.page.ts","./src/app/pages/notification-settings/notification-settings.page.html"],"sourcesContent":["import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { NotificationSettingsPage } from './notification-settings.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: NotificationSettingsPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class NotificationSettingsPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { NotificationSettingsPageRoutingModule } from './notification-settings-routing.module';\n\nimport { NotificationSettingsPage } from './notification-settings.page';\nimport { TranslateModule } from '@ngx-translate/core';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    TranslateModule,\n    NotificationSettingsPageRoutingModule\n  ],\n  declarations: [NotificationSettingsPage]\n})\nexport class NotificationSettingsPageModule {}\n","import { Component } from '@angular/core';\nimport { Plugins } from '@capacitor/core';\nimport { TranslateService } from '@ngx-translate/core';\nimport * as _ from 'lodash';\nimport { DEFAULTS, STORAGE } from 'src/app/models/constants';\nimport { StorageService } from 'src/app/services/storage/storage.service';\nimport { UtilsService } from 'src/app/services/utils/utils.service';\nconst { LocalNotifications } = Plugins;\ndeclare var cordova: any;\n\n@Component({\n  selector: 'app-notification-settings',\n  templateUrl: './notification-settings.page.html',\n  styleUrls: ['./notification-settings.page.scss'],\n})\nexport class NotificationSettingsPage {\n\n  public time = DEFAULTS.NOTIFICATION_TIME\n  public weekdays = DEFAULTS.NOTIFICATION_WEEKDAYS\n\n  constructor(\n    private utils: UtilsService,\n    private storage: StorageService,\n    private translateService: TranslateService,\n  ) {\n    this.init()\n  }\n\n  async init() {\n    this.time = await this.storage.getString(STORAGE.SETTINGS_NOTIFICATIONS_TIME, DEFAULTS.NOTIFICATION_TIME)\n    this.weekdays = JSON.parse(await this.storage.getString(STORAGE.SETTINGS_NOTIFICATIONS_WEEKDAYS, JSON.stringify(DEFAULTS.NOTIFICATION_WEEKDAYS)))\n  }\n\n  private async storeConfiguration() {\n    await this.storage.setItem(STORAGE.SETTINGS_NOTIFICATIONS_TIME, this.time)\n    await this.storage.setItem(STORAGE.SETTINGS_NOTIFICATIONS_WEEKDAYS, JSON.stringify(this.weekdays))\n    this.utils.showToast('Updated')\n  }\n\n  private async cancelNotifications() {\n    let pending = await LocalNotifications.getPending()\n    LocalNotifications.cancel(pending)\n  }\n\n  private async scheduleNotifications() {\n    let hour = parseInt(this.time.split(':')[0])\n    let minute = parseInt(this.time.split(':')[1])\n    let notifications = []\n    var counter = 1;\n    const title = await this.translateService.get('BexTrack').toPromise()\n    const text = await this.translateService.get('Did you track your time for today?').toPromise()\n    for (let key of Object.keys(this.weekdays)) {\n      if (this.weekdays[key]) {\n        let weekday = parseInt(key.substring(1))\n        notifications.push(\n          {\n            id: counter,\n            title: title,\n            text: text,\n            foreground: true,\n            trigger: {\n              every: {\n                weekday: weekday,\n                hour: hour,\n                minute: minute\n              }\n            }\n          }\n        );\n        counter++;\n      }\n    }\n    if (notifications.length > 0) {\n      try {\n        cordova.plugins.notification.local.schedule(notifications);\n      } catch (e) {\n        console.error('Schedule Notifications', e)\n      }\n    }\n  }\n\n  notificationsChanged = _.debounce(async () => {\n    this.utils.requestNotificationPermission()\n    await this.storeConfiguration()\n    await this.cancelNotifications()\n    this.scheduleNotifications()\n  }, 2000);\n\n}\n","<ion-header>\n  <ion-toolbar color=\"primary\">\n    <ion-buttons slot=\"start\">\n      <ion-back-button mode=\"md\" defaultHref=\"/tabs/settings\"></ion-back-button>\n    </ion-buttons>\n    <ion-title>\n      {{ 'Notification settings' | translate }}\n    </ion-title>\n  </ion-toolbar>\n</ion-header>\n\n<ion-content>\n  <ion-list>\n    <ion-list-header>{{ 'Time tracking reminder' | translate }}</ion-list-header>\n    <ion-item>\n      <ion-label>{{ 'Reminder time' | translate }}</ion-label>\n      <ion-datetime displayFormat=\"HH:mm\" [(ngModel)]=\"time\" (ionChange)=\"notificationsChanged()\"></ion-datetime>\n    </ion-item>\n    <ion-item>\n      <ion-label>{{ 'Monday' | translate }}</ion-label>\n      <ion-checkbox slot=\"end\" [(ngModel)]=\"weekdays.d1\" (ionChange)=\"notificationsChanged()\"></ion-checkbox>\n    </ion-item>\n    <ion-item>\n      <ion-label>{{ 'Tuesday' | translate }}</ion-label>\n      <ion-checkbox slot=\"end\" [(ngModel)]=\"weekdays.d2\" (ionChange)=\"notificationsChanged()\"></ion-checkbox>\n    </ion-item>\n    <ion-item>\n      <ion-label>{{ 'Wednesday' | translate }}</ion-label>\n      <ion-checkbox slot=\"end\" [(ngModel)]=\"weekdays.d3\" (ionChange)=\"notificationsChanged()\"></ion-checkbox>\n    </ion-item>\n    <ion-item>\n      <ion-label>{{ 'Thursday' | translate }}</ion-label>\n      <ion-checkbox slot=\"end\" [(ngModel)]=\"weekdays.d4\" (ionChange)=\"notificationsChanged()\"></ion-checkbox>\n    </ion-item>\n    <ion-item>\n      <ion-label>{{ 'Friday' | translate }}</ion-label>\n      <ion-checkbox slot=\"end\" [(ngModel)]=\"weekdays.d5\" (ionChange)=\"notificationsChanged()\"></ion-checkbox>\n    </ion-item>\n    <ion-item>\n      <ion-label>{{ 'Saturday' | translate }}</ion-label>\n      <ion-checkbox slot=\"end\" [(ngModel)]=\"weekdays.d6\" (ionChange)=\"notificationsChanged()\"></ion-checkbox>\n    </ion-item>\n    <ion-item>\n      <ion-label>{{ 'Sunday' | translate }}</ion-label>\n      <ion-checkbox slot=\"end\" [(ngModel)]=\"weekdays.d0\" (ionChange)=\"notificationsChanged()\"></ion-checkbox>\n    </ion-item>\n  </ion-list>\n</ion-content>"],"names":["RouterModule","NotificationSettingsPage","routes","path","component","NotificationSettingsPageRoutingModule","forChild","imports","exports","CommonModule","FormsModule","IonicModule","TranslateModule","NotificationSettingsPageModule","declarations","Plugins","_","DEFAULTS","STORAGE","LocalNotifications","constructor","utils","storage","translateService","NOTIFICATION_TIME","NOTIFICATION_WEEKDAYS","debounce","_this","requestNotificationPermission","storeConfiguration","cancelNotifications","scheduleNotifications","init","_this2","time","getString","SETTINGS_NOTIFICATIONS_TIME","weekdays","JSON","parse","SETTINGS_NOTIFICATIONS_WEEKDAYS","stringify","_this3","setItem","showToast","pending","getPending","cancel","hour","parseInt","_this4","split","minute","notifications","counter","title","get","toPromise","text","key","Object","keys","weekday","substring","push","id","foreground","trigger","every","length","cordova","plugins","notification","local","schedule","e","console","error","selectors","decls","vars","consts","template","i0","ctx"],"sourceRoot":"webpack:///","x_google_ignoreList":[]}