"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2181],{2181:(F,m,r)=>{r.r(m),r.d(m,{CreateStopwatchPageModule:()=>B});var d=r(6895),h=r(4006),i=r(8058),s=r(5861),u=r(1052),p=r(7432),e=r(8274),_=r(5146),g=r(2835),v=r(3018),w=r(6578),f=r(9265),S=r(2466);function T(a,c){1&a&&(e.\u0275\u0275elementStart(0,"ion-title"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&a&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(2,1,"Update stopwatch")))}function I(a,c){1&a&&(e.\u0275\u0275elementStart(0,"ion-title"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&a&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(2,1,"Create stopwatch")))}function P(a,c){if(1&a&&(e.\u0275\u0275elementStart(0,"ion-select-option",15),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&a){const t=c.$implicit;e.\u0275\u0275property("value",t.id),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",t.name," ")}}function C(a,c){if(1&a&&(e.\u0275\u0275elementStart(0,"ion-select-option",15),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&a){const t=c.$implicit;e.\u0275\u0275propertyInterpolate("value",t.id),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1("",t.name," ")}}function y(a,c){if(1&a&&(e.\u0275\u0275elementStart(0,"ion-select-option",15),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&a){const t=c.$implicit;e.\u0275\u0275propertyInterpolate("value",t.id),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1("",t.name," ")}}function E(a,c){if(1&a&&(e.\u0275\u0275elementStart(0,"ion-select-option",15),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&a){const t=c.$implicit;e.\u0275\u0275property("value",t.id),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1("",t.name," ")}}let M=(()=>{class a{constructor(t,n,o,l,b,N,k){this.apiService=t,this.router=n,this.route=o,this.stopwatchesService=l,this.navController=b,this.storage=N,this.utils=k,this.isUpdate=!1,this.availablePackages=[],this.projects=[],this.clientServices=[],this.timesheetStatus=[],this.contact=null,this.stopwatch=new u.u,this.init()}init(){var t=this;return(0,s.Z)(function*(){t.projects=yield t.apiService.getProjects(),t.clientServices=yield t.apiService.getClientService(),t.timesheetStatus=yield t.apiService.getTimesheetStatus(),(yield t.storage.getString(p.P_.SETTINGS_LAST_SERVICE,p.Of.SERVICE_ID))!=p.vK.NONE&&(t.stopwatch.client_service_id=yield t.storage.getNumber(p.P_.SETTINGS_LAST_SERVICE_ID),t.updateClientServices()),(yield t.storage.getString(p.P_.SETTINGS_LAST_STATUS,p.Of.STATUS_ID))!=p.vK.NONE&&(t.stopwatch.status_id=yield t.storage.getNumber(p.P_.SETTINGS_LAST_STATUS_ID),t.updateStatus()),(yield t.storage.getString(p.P_.SETTINGS_LAST_PROJECT,p.Of.PROJECT_ID))!=p.vK.NONE&&(t.stopwatch.pr_project_id=yield t.storage.getNumber(p.P_.SETTINGS_LAST_PROJECT_ID),t.availablePackages=yield t.apiService.getPackagesForProject(t.stopwatch.pr_project_id),t.updateSelectTexts()),t.route.params.subscribe(function(){var n=(0,s.Z)(function*(o){if(o.stopwatch_id){t.isUpdate=!0;let l=yield t.stopwatchesService.get(o.stopwatch_id);l&&(t.stopwatch=l,t.availablePackages=yield t.apiService.getPackagesForProject(t.stopwatch.pr_project_id))}t.updateSelectTexts()});return function(o){return n.apply(this,arguments)}}())})()}updateClientServices(){var t=this;return(0,s.Z)(function*(){const n=t.clientServices.filter(o=>o.id==t.stopwatch.client_service_id);n.length>0&&(t.stopwatch.selectedClientServiceText=n[0].name)})()}updateStatus(){var t=this;return(0,s.Z)(function*(){const n=t.timesheetStatus.filter(o=>o.id==t.stopwatch.status_id);n.length>0&&(t.stopwatch.selectedStatusText=n[0].name)})()}updateSelectTexts(){var t=this;return(0,s.Z)(function*(){const n=t.projects.filter(o=>o.id==t.stopwatch.pr_project_id);n.length>0&&(t.stopwatch.selectedProjectText=n[0].name,t.stopwatch.contact_id=n[0].contact_id,console.log("selectedProjectText",t.stopwatch.selectedProjectText),console.log("pr_package_id",t.stopwatch.pr_package_id),t.stopwatch.pr_package_id&&(t.stopwatch.selectedPackageText=(yield t.apiService.getPackageForProjectWithId(t.stopwatch.pr_project_id,t.stopwatch.pr_package_id)).name,console.log("selectedPackageText",t.stopwatch.selectedPackageText)))})()}onProjectSelected(){var t=this;return(0,s.Z)(function*(){t.availablePackages=yield t.apiService.getPackagesForProject(t.stopwatch.pr_project_id),t.updateSelectTexts()})()}save(){var t=this;return(0,s.Z)(function*(){if(!t.stopwatch.title||t.stopwatch.title.length<1||!t.stopwatch.text||t.stopwatch.text.length<1||!t.stopwatch.client_service_id||!t.stopwatch.status_id)return t.utils.showToast("Missing information"),!1;yield t.stopwatchesService.add(t.stopwatch),t.utils.showToast(t.isUpdate?"Updated":"Created"),t.navController.navigateRoot("/tabs/stopwatches")})()}contactChange(t){console.log("port:",t.value)}searchContact(t){var n=this;return(0,s.Z)(function*(){let o=t.text.trim().toLowerCase();t.component.startSearch(),t.component.items=yield n.apiService.searchContact(o),t.component.endSearch()})()}}return a.\u0275fac=function(t){return new(t||a)(e.\u0275\u0275directiveInject(_.s),e.\u0275\u0275directiveInject(g.F0),e.\u0275\u0275directiveInject(g.gz),e.\u0275\u0275directiveInject(v.W),e.\u0275\u0275directiveInject(i.NavController),e.\u0275\u0275directiveInject(w.V),e.\u0275\u0275directiveInject(f.F))},a.\u0275cmp=e.\u0275\u0275defineComponent({type:a,selectors:[["app-stopwatch"]],decls:68,vars:66,consts:[["color","primary"],["slot","start"],["mode","md","defaultHref","/tabs/stopwatches"],["slot","end"],[3,"click"],["slot","icon-only","name","save"],[4,"ngIf"],["position","stacked"],["autoGrow","true","placeholder","Text",3,"ngModel","ngModelChange"],[3,"ngModel","ngModelChange"],[3,"placeholder","ngModel","selectedText","ionChange","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["position","floating"],["placeholder","Select",3,"ngModel","selectedText","ionChange","ngModelChange"],[3,"placeholder","ngModel","ngModelChange"],[3,"value"]],template:function(t,n){1&t&&(e.\u0275\u0275elementStart(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-buttons",1),e.\u0275\u0275element(3,"ion-back-button",2),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"ion-buttons",3)(5,"ion-button",4),e.\u0275\u0275listener("click",function(){return n.save()}),e.\u0275\u0275element(6,"ion-icon",5),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(7,T,3,3,"ion-title",6),e.\u0275\u0275template(8,I,3,3,"ion-title",6),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(9,"ion-content")(10,"ion-list")(11,"ion-item")(12,"ion-label",7),e.\u0275\u0275text(13),e.\u0275\u0275pipe(14,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(15,"ion-textarea",8),e.\u0275\u0275listener("ngModelChange",function(l){return n.stopwatch.title=l}),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(16,"ion-item")(17,"ion-label"),e.\u0275\u0275text(18),e.\u0275\u0275pipe(19,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(20,"ion-toggle",9),e.\u0275\u0275listener("ngModelChange",function(l){return n.stopwatch.allowable_bill=l}),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(21,"ion-item")(22,"ion-label",7),e.\u0275\u0275text(23),e.\u0275\u0275pipe(24,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(25,"ion-select",10),e.\u0275\u0275listener("ionChange",function(){return n.updateClientServices()})("ngModelChange",function(l){return n.stopwatch.client_service_id=l}),e.\u0275\u0275pipe(26,"translate"),e.\u0275\u0275template(27,P,2,2,"ion-select-option",11),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(28,"ion-item")(29,"ion-label",12),e.\u0275\u0275text(30),e.\u0275\u0275pipe(31,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(32,"ion-select",10),e.\u0275\u0275listener("ionChange",function(){return n.onProjectSelected()})("ngModelChange",function(l){return n.stopwatch.pr_project_id=l}),e.\u0275\u0275pipe(33,"translate"),e.\u0275\u0275template(34,C,2,2,"ion-select-option",11),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(35,"ion-item")(36,"ion-label",12),e.\u0275\u0275text(37),e.\u0275\u0275pipe(38,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(39,"ion-select",10),e.\u0275\u0275listener("ionChange",function(){return n.onProjectSelected()})("ngModelChange",function(l){return n.stopwatch.pr_package_id=l}),e.\u0275\u0275pipe(40,"translate"),e.\u0275\u0275template(41,y,2,2,"ion-select-option",11),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(42,"ion-item")(43,"ion-label",7),e.\u0275\u0275text(44),e.\u0275\u0275pipe(45,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(46,"ion-select",13),e.\u0275\u0275listener("ionChange",function(){return n.updateStatus()})("ngModelChange",function(l){return n.stopwatch.status_id=l}),e.\u0275\u0275template(47,E,2,2,"ion-select-option",11),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(48,"ion-item")(49,"ion-label",7),e.\u0275\u0275text(50),e.\u0275\u0275pipe(51,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(52,"ion-textarea",8),e.\u0275\u0275listener("ngModelChange",function(l){return n.stopwatch.text=l}),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(53,"ion-item")(54,"ion-label",12),e.\u0275\u0275text(55),e.\u0275\u0275pipe(56,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(57,"ion-select",14),e.\u0275\u0275listener("ngModelChange",function(l){return n.stopwatch.strategy=l}),e.\u0275\u0275pipe(58,"translate"),e.\u0275\u0275elementStart(59,"ion-select-option",15),e.\u0275\u0275text(60),e.\u0275\u0275pipe(61,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(62,"ion-select-option",15),e.\u0275\u0275text(63),e.\u0275\u0275pipe(64,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(65,"ion-select-option",15),e.\u0275\u0275text(66),e.\u0275\u0275pipe(67,"translate"),e.\u0275\u0275elementEnd()()()()()),2&t&&(e.\u0275\u0275advance(7),e.\u0275\u0275property("ngIf",n.isUpdate),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!n.isUpdate),e.\u0275\u0275advance(5),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(14,36,"Stopwatch title")),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngModel",n.stopwatch.title),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(19,38,"Chargeable")),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngModel",n.stopwatch.allowable_bill),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1("",e.\u0275\u0275pipeBind1(24,40,"Service"),"*"),e.\u0275\u0275advance(2),e.\u0275\u0275propertyInterpolate("placeholder",e.\u0275\u0275pipeBind1(26,42,"Service")),e.\u0275\u0275property("ngModel",n.stopwatch.client_service_id)("selectedText",n.stopwatch.selectedClientServiceText),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",n.clientServices),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(31,44,"Project")),e.\u0275\u0275advance(2),e.\u0275\u0275propertyInterpolate("placeholder",e.\u0275\u0275pipeBind1(33,46,"Project")),e.\u0275\u0275property("ngModel",n.stopwatch.pr_project_id)("selectedText",n.stopwatch.selectedProjectText),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",n.projects),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(38,48,"Package")),e.\u0275\u0275advance(2),e.\u0275\u0275propertyInterpolate("placeholder",e.\u0275\u0275pipeBind1(40,50,"Package")),e.\u0275\u0275property("ngModel",n.stopwatch.pr_package_id)("selectedText",n.stopwatch.selectedPackageText),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",n.availablePackages),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1("",e.\u0275\u0275pipeBind1(45,52,"Status"),"*"),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngModel",n.stopwatch.status_id)("selectedText",n.stopwatch.selectedStatusText),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",n.timesheetStatus),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1("",e.\u0275\u0275pipeBind1(51,54,"Description"),"*"),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngModel",n.stopwatch.text),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(56,56,"Strategy")),e.\u0275\u0275advance(2),e.\u0275\u0275propertyInterpolate("placeholder",e.\u0275\u0275pipeBind1(58,58,"Strategy")),e.\u0275\u0275property("ngModel",n.stopwatch.strategy),e.\u0275\u0275advance(2),e.\u0275\u0275property("value",0),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(61,60,"Always ask")),e.\u0275\u0275advance(2),e.\u0275\u0275property("value",1),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(64,62,"Automatically create")),e.\u0275\u0275advance(2),e.\u0275\u0275property("value",2),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(67,64,"Always edit")))},dependencies:[d.NgForOf,d.NgIf,h.NgControlStatus,h.NgModel,i.IonBackButton,i.IonButton,i.IonButtons,i.IonContent,i.IonHeader,i.IonIcon,i.IonItem,i.IonLabel,i.IonList,i.IonSelect,i.IonSelectOption,i.IonTextarea,i.IonTitle,i.IonToggle,i.IonToolbar,i.BooleanValueAccessor,i.SelectValueAccessor,i.TextValueAccessor,i.IonBackButtonDelegate,S.X$]}),a})();var x=r(5503),j=r(6386);let B=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.\u0275\u0275defineNgModule({type:a}),a.\u0275inj=e.\u0275\u0275defineInjector({imports:[d.CommonModule,h.FormsModule,i.IonicModule,S.aw,x.D,j.UV,g.Bz.forChild([{path:"",component:M}])]}),a})()}}]);