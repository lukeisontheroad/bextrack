"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[9185],{9185:(Y,S,l)=>{l.r(S),l.d(S,{CreateStopwatchPageModule:()=>$});var g=l(177),d=l(9417),u=l(3871),s=l(4742),_=l(3955),T=l(8548),w=l(1683),h=l(467),p=l(8),v=l(7316),t=l(6996),f=l(6929),m=l(7897),C=l(2872),P=l(5217),M=l(9893);function j(o,r){1&o&&(t.j41(0,"ion-title"),t.EFF(1),t.nI1(2,"translate"),t.k0s()),2&o&&(t.R7$(1),t.JRh(t.bMT(2,1,"Update stopwatch")))}function I(o,r){1&o&&(t.j41(0,"ion-title"),t.EFF(1),t.nI1(2,"translate"),t.k0s()),2&o&&(t.R7$(1),t.JRh(t.bMT(2,1,"Create stopwatch")))}function F(o,r){if(1&o&&(t.j41(0,"ion-select-option",15),t.EFF(1),t.k0s()),2&o){const c=r.$implicit;t.Y8G("value",c.id),t.R7$(1),t.SpI(" ",c.name," ")}}function R(o,r){if(1&o&&(t.j41(0,"ion-select-option",15),t.EFF(1),t.k0s()),2&o){const c=r.$implicit;t.FS9("value",c.id),t.R7$(1),t.SpI("",c.name," ")}}function b(o,r){if(1&o&&(t.j41(0,"ion-select-option",15),t.EFF(1),t.k0s()),2&o){const c=r.$implicit;t.FS9("value",c.id),t.R7$(1),t.SpI("",c.name," ")}}function E(o,r){if(1&o&&(t.j41(0,"ion-select-option",15),t.EFF(1),t.k0s()),2&o){const c=r.$implicit;t.Y8G("value",c.id),t.R7$(1),t.SpI("",c.name," ")}}let k=(()=>{var o;class r{constructor(e,a,n,i,y,G){this.apiService=e,this.route=a,this.stopwatchesService=n,this.navController=i,this.storage=y,this.utils=G,this.isUpdate=!1,this.availablePackages=[],this.projects=[],this.clientServices=[],this.timesheetStatus=[],this.contact=null,this.stopwatch=new v.e,this.init()}init(){var e=this;return(0,h.A)(function*(){e.projects=yield e.apiService.getProjects(),e.clientServices=yield e.apiService.getClientService(),e.timesheetStatus=yield e.apiService.getTimesheetStatus(),(yield e.storage.getString(p.O3.SETTINGS_LAST_SERVICE,p.zY.SERVICE_ID))!==p.QE.NONE&&(e.stopwatch.client_service_id=yield e.storage.getNumber(p.O3.SETTINGS_LAST_SERVICE_ID),e.updateClientServices()),(yield e.storage.getString(p.O3.SETTINGS_LAST_STATUS,p.zY.STATUS_ID))!==p.QE.NONE&&(e.stopwatch.status_id=yield e.storage.getNumber(p.O3.SETTINGS_LAST_STATUS_ID),e.updateStatus()),(yield e.storage.getString(p.O3.SETTINGS_LAST_PROJECT,p.zY.PROJECT_ID))!==p.QE.NONE&&(e.stopwatch.pr_project_id=yield e.storage.getNumber(p.O3.SETTINGS_LAST_PROJECT_ID),e.availablePackages=yield e.apiService.getPackagesForProject(e.stopwatch.pr_project_id),e.updateSelectTexts()),e.route.params.subscribe(function(){var a=(0,h.A)(function*(n){if(n.stopwatch_id){e.isUpdate=!0;const i=yield e.stopwatchesService.get(n.stopwatch_id);i&&(e.stopwatch=i,e.availablePackages=yield e.apiService.getPackagesForProject(e.stopwatch.pr_project_id))}e.updateSelectTexts()});return function(n){return a.apply(this,arguments)}}())})()}updateClientServices(){var e=this;return(0,h.A)(function*(){const a=e.clientServices.filter(n=>n.id===e.stopwatch.client_service_id);a.length>0&&(e.stopwatch.selectedClientServiceText=a[0].name)})()}updateStatus(){var e=this;return(0,h.A)(function*(){const a=e.timesheetStatus.filter(n=>n.id===e.stopwatch.status_id);a.length>0&&(e.stopwatch.selectedStatusText=a[0].name)})()}updateSelectTexts(){var e=this;return(0,h.A)(function*(){const a=e.projects.filter(n=>n.id===e.stopwatch.pr_project_id);a.length>0&&(e.stopwatch.selectedProjectText=a[0].name,e.stopwatch.contact_id=a[0].contact_id,console.log("selectedProjectText",e.stopwatch.selectedProjectText),console.log("pr_package_id",e.stopwatch.pr_package_id),e.stopwatch.pr_package_id&&(e.stopwatch.selectedPackageText=(yield e.apiService.getPackageForProjectWithId(e.stopwatch.pr_project_id,e.stopwatch.pr_package_id)).name,console.log("selectedPackageText",e.stopwatch.selectedPackageText)))})()}onProjectSelected(){var e=this;return(0,h.A)(function*(){e.availablePackages=yield e.apiService.getPackagesForProject(e.stopwatch.pr_project_id),e.updateSelectTexts()})()}save(){var e=this;return(0,h.A)(function*(){if(!e.stopwatch.title||e.stopwatch.title.length<1||!e.stopwatch.text||e.stopwatch.text.length<1||!e.stopwatch.client_service_id||!e.stopwatch.status_id)return e.utils.showToast("Missing information"),!1;yield e.stopwatchesService.add(e.stopwatch),e.utils.showToast(e.isUpdate?"Updated":"Created"),e.navController.navigateRoot("/tabs/stopwatches")})()}contactChange(e){console.log("port:",e.value)}searchContact(e){var a=this;return(0,h.A)(function*(){const n=e.text.trim().toLowerCase();e.component.startSearch(),e.component.items=yield a.apiService.searchContact(n),e.component.endSearch()})()}}return(o=r).\u0275fac=function(e){return new(e||o)(t.rXU(f.G),t.rXU(u.nX),t.rXU(m.x),t.rXU(C.q9),t.rXU(P.n),t.rXU(M.T))},o.\u0275cmp=t.VBU({type:o,selectors:[["app-stopwatch"]],decls:68,vars:66,consts:[["color","primary"],["slot","start"],["mode","md","defaultHref","/tabs/stopwatches"],["slot","end"],[3,"click"],["slot","icon-only","name","save"],[4,"ngIf"],["position","stacked"],["autoGrow","true","placeholder","Text",3,"ngModel","ngModelChange"],[3,"ngModel","ngModelChange"],[3,"placeholder","ngModel","selectedText","ionChange","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["position","floating"],["placeholder","Select",3,"ngModel","selectedText","ionChange","ngModelChange"],[3,"placeholder","ngModel","ngModelChange"],[3,"value"]],template:function(e,a){1&e&&(t.j41(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-buttons",1),t.nrm(3,"ion-back-button",2),t.k0s(),t.j41(4,"ion-buttons",3)(5,"ion-button",4),t.bIt("click",function(){return a.save()}),t.nrm(6,"ion-icon",5),t.k0s()(),t.DNE(7,j,3,3,"ion-title",6),t.DNE(8,I,3,3,"ion-title",6),t.k0s()(),t.j41(9,"ion-content")(10,"ion-list")(11,"ion-item")(12,"ion-label",7),t.EFF(13),t.nI1(14,"translate"),t.k0s(),t.j41(15,"ion-textarea",8),t.bIt("ngModelChange",function(i){return a.stopwatch.title=i}),t.k0s()(),t.j41(16,"ion-item")(17,"ion-label"),t.EFF(18),t.nI1(19,"translate"),t.k0s(),t.j41(20,"ion-toggle",9),t.bIt("ngModelChange",function(i){return a.stopwatch.allowable_bill=i}),t.k0s()(),t.j41(21,"ion-item")(22,"ion-label",7),t.EFF(23),t.nI1(24,"translate"),t.k0s(),t.j41(25,"ion-select",10),t.bIt("ionChange",function(){return a.updateClientServices()})("ngModelChange",function(i){return a.stopwatch.client_service_id=i}),t.nI1(26,"translate"),t.DNE(27,F,2,2,"ion-select-option",11),t.k0s()(),t.j41(28,"ion-item")(29,"ion-label",12),t.EFF(30),t.nI1(31,"translate"),t.k0s(),t.j41(32,"ion-select",10),t.bIt("ionChange",function(){return a.onProjectSelected()})("ngModelChange",function(i){return a.stopwatch.pr_project_id=i}),t.nI1(33,"translate"),t.DNE(34,R,2,2,"ion-select-option",11),t.k0s()(),t.j41(35,"ion-item")(36,"ion-label",12),t.EFF(37),t.nI1(38,"translate"),t.k0s(),t.j41(39,"ion-select",10),t.bIt("ionChange",function(){return a.onProjectSelected()})("ngModelChange",function(i){return a.stopwatch.pr_package_id=i}),t.nI1(40,"translate"),t.DNE(41,b,2,2,"ion-select-option",11),t.k0s()(),t.j41(42,"ion-item")(43,"ion-label",7),t.EFF(44),t.nI1(45,"translate"),t.k0s(),t.j41(46,"ion-select",13),t.bIt("ionChange",function(){return a.updateStatus()})("ngModelChange",function(i){return a.stopwatch.status_id=i}),t.DNE(47,E,2,2,"ion-select-option",11),t.k0s()(),t.j41(48,"ion-item")(49,"ion-label",7),t.EFF(50),t.nI1(51,"translate"),t.k0s(),t.j41(52,"ion-textarea",8),t.bIt("ngModelChange",function(i){return a.stopwatch.text=i}),t.k0s()(),t.j41(53,"ion-item")(54,"ion-label",12),t.EFF(55),t.nI1(56,"translate"),t.k0s(),t.j41(57,"ion-select",14),t.bIt("ngModelChange",function(i){return a.stopwatch.strategy=i}),t.nI1(58,"translate"),t.j41(59,"ion-select-option",15),t.EFF(60),t.nI1(61,"translate"),t.k0s(),t.j41(62,"ion-select-option",15),t.EFF(63),t.nI1(64,"translate"),t.k0s(),t.j41(65,"ion-select-option",15),t.EFF(66),t.nI1(67,"translate"),t.k0s()()()()()),2&e&&(t.R7$(7),t.Y8G("ngIf",a.isUpdate),t.R7$(1),t.Y8G("ngIf",!a.isUpdate),t.R7$(5),t.JRh(t.bMT(14,36,"Stopwatch title")),t.R7$(2),t.Y8G("ngModel",a.stopwatch.title),t.R7$(3),t.JRh(t.bMT(19,38,"Chargeable")),t.R7$(2),t.Y8G("ngModel",a.stopwatch.allowable_bill),t.R7$(3),t.SpI("",t.bMT(24,40,"Service"),"*"),t.R7$(2),t.FS9("placeholder",t.bMT(26,42,"Service")),t.Y8G("ngModel",a.stopwatch.client_service_id)("selectedText",a.stopwatch.selectedClientServiceText),t.R7$(2),t.Y8G("ngForOf",a.clientServices),t.R7$(3),t.JRh(t.bMT(31,44,"Project")),t.R7$(2),t.FS9("placeholder",t.bMT(33,46,"Project")),t.Y8G("ngModel",a.stopwatch.pr_project_id)("selectedText",a.stopwatch.selectedProjectText),t.R7$(2),t.Y8G("ngForOf",a.projects),t.R7$(3),t.JRh(t.bMT(38,48,"Package")),t.R7$(2),t.FS9("placeholder",t.bMT(40,50,"Package")),t.Y8G("ngModel",a.stopwatch.pr_package_id)("selectedText",a.stopwatch.selectedPackageText),t.R7$(2),t.Y8G("ngForOf",a.availablePackages),t.R7$(3),t.SpI("",t.bMT(45,52,"Status"),"*"),t.R7$(2),t.Y8G("ngModel",a.stopwatch.status_id)("selectedText",a.stopwatch.selectedStatusText),t.R7$(1),t.Y8G("ngForOf",a.timesheetStatus),t.R7$(3),t.SpI("",t.bMT(51,54,"Description"),"*"),t.R7$(2),t.Y8G("ngModel",a.stopwatch.text),t.R7$(3),t.JRh(t.bMT(56,56,"Strategy")),t.R7$(2),t.FS9("placeholder",t.bMT(58,58,"Strategy")),t.Y8G("ngModel",a.stopwatch.strategy),t.R7$(2),t.Y8G("value",0),t.R7$(1),t.JRh(t.bMT(61,60,"Always ask")),t.R7$(2),t.Y8G("value",1),t.R7$(1),t.JRh(t.bMT(64,62,"Automatically create")),t.R7$(2),t.Y8G("value",2),t.R7$(1),t.JRh(t.bMT(67,64,"Always edit")))},dependencies:[g.Sq,g.bT,d.BC,d.vS,s.Jm,s.QW,s.W9,s.eU,s.iq,s.uz,s.he,s.nf,s.Nm,s.Ip,s.nc,s.BC,s.BY,s.ai,s.hB,s.Je,s.Gw,s.el,_.D9]}),r})(),$=(()=>{var o;class r{}return(o=r).\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.$C({type:o}),o.\u0275inj=t.G2t({providers:[T.rz],imports:[g.MD,d.YN,s.bv,_.h,w.Y,u.iI.forChild([{path:"",component:k}])]}),r})()}}]);