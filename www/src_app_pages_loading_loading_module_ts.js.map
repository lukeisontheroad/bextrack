{"version":3,"file":"src_app_pages_loading_loading_module_ts.js","mappings":"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","sources":["./src/app/pages/loading/loading.module.ts","./src/app/pages/loading/loading.page.ts","./src/app/pages/loading/loading.page.html"],"sourcesContent":["import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { IonicModule } from '@ionic/angular';\nimport { LoadingPage } from './loading.page';\nimport { RouterModule } from '@angular/router';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    RouterModule.forChild([{ path: '', component: LoadingPage }])\n  ],\n  declarations: [LoadingPage]\n})\nexport class LoadingPageModule {}\n","import { Component, OnDestroy, OnInit } from '@angular/core';\nimport { NavController } from '@ionic/angular';\nimport { AuthActions, AuthObserver, AuthService, IAuthAction } from 'ionic-appauth';\nimport { ApiService } from 'src/app/services/api/api.service';\nimport { UtilsService } from 'src/app/services/utils/utils.service';\n\n@Component({\n  selector: 'app-loading',\n  templateUrl: './loading.page.html',\n  styleUrls: ['./loading.page.scss'],\n})\nexport class LoadingPage implements OnInit, OnDestroy {\n\n  observer: AuthObserver;\n\n  constructor(\n    private auth: AuthService,\n    private apiService: ApiService,\n    private navCtrl: NavController,\n    private utilsService: UtilsService\n  ) { }\n\n  async ngOnInit() {\n    this.observer = this.auth.addActionListener((action) => this.actionHandler(action));\n    this.auth.loadTokenFromStorage().then(async value => {\n      this.auth.getValidToken().then( async() => {\n        this.initApiService()\n      }).catch(() => {\n        this.auth.refreshToken().then(async value => {\n          this.initApiService()\n        })\n      })\n    })\n  }\n\n  async initApiService(){\n    try {\n      await this.apiService.init()\n      this.navCtrl.navigateRoot('tabs')\n    } catch (e) {\n      if(e.error && e.error.error_code && e.error.error_code == 403 && e.error.message && e.error.message == 'You are not allowed to access this ressource.'){\n        this.utilsService.showToast('no-time-permissions')\n      }else if(e.error && e.error.message){\n        this.utilsService.showToast(e.error.message)\n      }else if(e.message){\n        this.utilsService.showToast(e.message)\n      }else{\n        this.utilsService.showToast('Error: ' + JSON.stringify(e))\n      }\n      this.navCtrl.navigateRoot('login')\n    }\n  }\n\n  actionHandler(action: IAuthAction) {\n    console.log('actionhandler', action)\n    if (action.error && action.action === AuthActions.LoadUserInfoFailed) {\n      this.navCtrl.navigateRoot('login');\n    }\n  }\n\n  ngOnDestroy() {\n    this.auth.removeActionObserver(this.observer);\n  }\n}\n","<ion-content color=\"primary\">\n  <ion-spinner color=\"secondary\" style=\"position: absolute; left: 40%; top: 40%; width:20%; height:20%;\"></ion-spinner>\n</ion-content>"],"names":["CommonModule","FormsModule","IonicModule","LoadingPage","RouterModule","LoadingPageModule","forChild","path","component","declarations","imports","AuthActions","constructor","auth","apiService","navCtrl","utilsService","ngOnInit","_this","observer","addActionListener","action","actionHandler","loadTokenFromStorage","then","value","getValidToken","initApiService","catch","refreshToken","_this2","init","navigateRoot","e","error","error_code","message","showToast","JSON","stringify","console","log","LoadUserInfoFailed","ngOnDestroy","removeActionObserver","selectors","decls","vars","consts","template","i0"],"sourceRoot":"webpack:///","x_google_ignoreList":[]}